Patches for 6.15.x

2025-08-26:
- sync with pull request 1817

2025-05-26:
- offset fixes for 6.15 release

2025-04-17
- fixes for 6.15-rc2

2025-04-03
- fixes for mainline pre-6.15
